<!--<div class="col-sm-12 col-md-12 col-lg-12" >
	<div class="row">
		<div class="col-sm-12 col-md-4 col-lg-4 pull-right">
			<img ng-src="{{refData.pharmacy.patient_profile_pic_url}}">
			<h5 style="text-align: center;border-bottom: 1px solid rgba(0,0,0,0.4)">{{refData.pharmacy.patient_firstname}} {{refData.pharmacy.patient_lastname}} <span style="display:block;font-size: 12px; color:#000">Patient</span><address style="display:block;font-size: 12px; color:#000">{{refData.pharmacy.patient_address}}, {{refData.pharmacy.patient_city}}, {{refData.pharmacy.patient_country}}</address></h5>
			<div id="accordion">
                <h6 style="color: #fff;padding:5px;text-align:center;margin:15px 0 20px">
                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="/#collapseSeven" aria-expanded="false" aria-controls="collapseSeven" style="background-color:#e97147; font-size: 18px;color:#fff;border-radius:10px;padding:10px">Bill Patient</a>
                </h6>                 
                <div style="list-style:none;font-size:18px" id="collapseSeven" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingSeven">
                     
                     <table>
                     	<tr>
                     		<thead>
                     			<th>Drug</th>
                     			<th>Cost</th>
                     		</thead>
                     	</tr>
                     	<tr>
                     		<tbody ng-repeat = "j in drugsForSurchage">
                     			<td style="width: 55%;padding:10px">{{j.name}}</td>
                     			<td style="width: 45%"><input type="number" ng-model="j.amount" style="padding:10px"></td>
                     		</tbody>
                     	</tr>
                     </table>
                     <div>
                     	<strong>Total : <em>{{str}}</em></strong>
                     </div>
                     <div style="text-align:center;margin-top:20px" ng-if="isFilled === true">
                     	<button style="background-color:#996b88;color:#fff;font-size:14px;border-radius:20px" ng-click="sendBill(refData.pharmacy.patient_id)">Send billing to patient</button>
                     </div>
                </div>
            </div>
		</div>
		<div class="col-sm-12 col-md-8 col-lg-8">
			
			<h6 style="border-bottom: 1px solid rgba(0,0,0,0.4); width: 180px">Referrence Details</h6>
			<ul class="ref-details">
				<li><strong>Referred By </strong>| {{refData.referral_title}} {{refData.referral_firstname}} {{refData.referral_lastname}} {{refData.referral_name}}</li>
				<li><strong>Date </strong>| {{refData.date | date: "mediumDate"}}</li>
				<li><strong>Time </strong>| {{refData.date | date: "mediumTime"}}</li>
				<li><strong>Ref.NO </strong>| {{refData.ref_id}}</li>
			</ul>
			<h6 style="border-bottom: 1px solid rgba(0,0,0,0.4); width: 180px">Prescription Details</h6>
			<p><strong>Tips:</strong> While attending to this patient, please tick the drug you have already given to the patient.
				Unticked drug is regarded as not available in your center<span style="display:block"> which can be forwarded to another center.</span></p>					
			<table style="width:100%">				
				<tr>
					<thead>
						<th><strong>S/N</strong></th>
						<th><strong>Drug name</strong></th>
						<th><strong>Dosage</strong></th>
						<th><strong>Frequency</strong></th>
						<th><strong>Duration</strong></th>
						<th>Tick</th>
					</thead>
				</tr>
				<tr>
					<tbody ng-repeat="prescription in refData.pharmacy.prescription_body">												
						<td>{{prescription.sn}}</td>
						<td ng-class="{strike: prescription.picked}">{{prescription.drug_name}}</td>						
						<td ng-class="{strike: prescription.picked}">{{prescription.dosage}}</td>
						<td ng-class="{strike: prescription.picked}">{{prescription.frequency}}</td>
						<td ng-class="{strike: prescription.picked}">{{prescription.duration}}</td>
						<td><input type="checkbox" ng-model= "prescription.picked" style="width:22px;height:22px;color:rgba(0,200,0,0.8)"></td>
					</tbody>
				</tr>						
			</table>			
			<div style="margin-top: 20px; margin-bottom: 30px">
				<button ng-click="done()">Done</button>
				<button ng-click="toAnotherPharmacy()">Forward unticked drug to a pharmacy</button>
				<button ng-click="toList(refData.pharmacy.patient_firstname,refData.pharmacy.patient_lastname,refData.pharmacy.patient_profile_pic_url,refData.ref_id,refData.date)" ng-if="allNote.length !== 0">Attend later</button>				
			</div>
			<div class="prescription-info">
				<p style="font-size: 18px; font-weight:100">This prescription was writen by:</p>
				<div class="row">
					<div class="col-sm-2 col-md-3 col-lg-3">			
						<img ng-src="{{refData.pharmacy.Doctor_profile_pic_url}}" style="height:100px; width:100px">
					</div>
					<div class="col-sm-10 col-md-9 col-lg-9">
						<article>					
							<h6> Dr. {{refData.pharmacy.doctor_firstname}} {{refData.pharmacy.doctor_lastname}}<span style="display:block;color:rgba(0,0,0,0.4)">{{refData.pharmacy.doctor_specialty}}<span></h6>
							<p>{{refData.pharmacy.doctor_phone}}</p>
							<address><strong>{{refData.pharmacy.doctor_work_place}}</strong>| {{refData.pharmacy.doctor_address}}, {{refData.pharmacy.doctor_city}}, {{refData.pharmacy.doctor_country}}</address>
							<a ng-href="{{refData.pharmacy.doctor_profile_url}}" style="color:rgba(0,255,0,0.6);cursor:pointer">View Dr. {{refData.pharmacy.doctor_firstname}} profile.</a>
						</article>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>-->



<div class="container">
    <div class="card p-2">
<div class="col-sm-12 col-md-12 col-lg-12" >
	<div class="row">
		<h3 class="card p-0" style="padding: 0">Patient Prescription</h3>
	</div>
	<div class="row">
		
		<div class="col-md-12 col-lg-12 col-sm-12  pt-1">
			<div style="max-height: 120px;max-width: 120px;display: inline-block;float: left">		
				<img class="img-responsive card" src="{{refData.pharmacy.patient_profile_pic_url}}">
			</div>	
			<div style="display: inline-block;float: left;padding-left: 15px">
				<div><strong>{{refData.pharmacy.patient_firstname}} {{refData.pharmacy.patient_lastname}}</strong></div>
				<div><strong>{{refData.pharmacy.patient_address}}, {{refData.pharmacy.patient_city}}, {{refData.pharmacy.patient_country}}</strong></div>
				<div><strong>{{refData.pharmacy.patient_age}}</strong></div>
				<div><strong>{{refData.pharmacy.patient_gender}}</strong></div>
			</div>
			<div class="clearfix"></div>		
			<h6 class="text-muted pb-1" style="border-bottom: 1px solid rgba(0,0,0,0.2);margin-top: 20px">Referrence Details</h6>
			<ul class="nav font-1_1">
				<li><strong>Referred By </strong>| {{refData.referral_title}} {{refData.referral_firstname}} {{refData.referral_lastname}} {{refData.referral_name}}</li>
				<li><strong>Date </strong>| {{refData.date | date: "mediumDate"}}</li>
				<li><strong>Time </strong>| {{refData.date | date: "mediumTime"}}</li>
				<li><strong>Ref.NO </strong>| {{refData.ref_id}}</li>
			</ul>
			<h6 class="text-muted pb-1 mt-2" style="border-bottom: 1px solid rgba(0,0,0,0.4);">Prescription Details</h6>
			<p><strong>Tips:</strong> While attending to this patient, please <strong>Tick</strong> the drug you have already given to the patient below.If dosage, frquency and duration fields are missing you can add them based on the drugs you already administered.
				<strong>Unticked drug </strong> is regarded as not available in your center<span style="display:block"> which you can <strong>forward to another center.</strong></span></p>	
				<div style="text-align: right;">
				<a href="" ng-click="refresh()"style="color:orange"><i class="fa fa-refresh"></i> Refresh</a>	
				</div>			
			<table class="table table-striped table-responsiv">				
				<tr>
					<thead>
						<th><strong>S/N</strong></th>
						<th><strong>Drug name</strong></th>
						<th><strong>Dosage</strong></th>
						<th><strong>Frequency</strong></th>
						<th><strong>Duration</strong></th>
						<th>Tick</th>
					</thead>
				</tr>
				<tr>
					<tbody ng-repeat="prescription in refData.pharmacy.prescription_body">											
						<td ng-if="!prescription.unavail">{{prescription.sn}}</td>
						<td ng-class="{strike: prescription.picked}" ng-if="!prescription.unavail">{{prescription.drug_name}}</td>						
						<td ng-class="{strike: prescription.picked}" ng-if="!prescription.unavail">{{prescription.dosage}}<input type="text" name="dosage" ng-model="prescription.dosage" class="form-control" ng-if="!refData.pharmacy.doctor_id"></td>
						<td ng-class="{strike: prescription.picked}" ng-if="!prescription.unavail">{{prescription.frequency}}<input type="text" name="dosage" ng-model="prescription.frequency" class="form-control" ng-if="!refData.pharmacy.doctor_id"></td>
						<td ng-class="{strike: prescription.picked}" ng-if="!prescription.unavail">{{prescription.duration}}<input type="text" name="dosage" ng-model="prescription.duration" class="form-control" ng-if="!refData.pharmacy.doctor_id"></td>
						<td ng-if="!prescription.unavail"><div>
					<label class="custom-control custom-checkbox">
					  <input type="checkbox" class="custom-control-input" ng-model= "prescription.picked" >
					  <span class="custom-control-indicator"></span>
					  <span class="custom-control-description" style="opacity:0;">.</span>
					</label>
					</div>
					</td>
					</tbody>
				</tr>
				
			</table>

			<div style="list-style:none;font-size:14px" ng-if="!refData.pharmacy.is_paid">
                <div>     
                     <table>
                     	<tr>
                     		<thead ng-if="isFilled === true">
                     			<th>Drug</th>
                     			<th>Cost</th>
                     		</thead>
                     	</tr>
                     	<tr>
                     		<tbody ng-repeat = "j in drugsForSurchage">
                     			<td style="width: 55%;padding:10px">{{j.name}}</td>
                     			<td style="width: 45%"><input type="number" ng-model="j.amount" style="padding:10px"></td>
                     		</tbody>
                     	</tr>
                     </table>
                     <div>
                     	<strong ng-if="isFilled === true">Total : <em>{{str}}</em></strong>
                     </div>
                </div>
            </div>
            <p ng-if="!refData.pharmacy.doctor_id && isFilled !== true"><i class="fa fa-warning text-danger"> The source of the above prescription is <strong>not trusted!</strong> It may has been prescribed by the patient or non-professional. <strong>Do Enquire</strong> from  this patient about the source before continuing. </i>
            </p>	
			<div style="margin-top: 20px; margin-bottom: 30px">
				<button  class="btn btn-simple btn-sm" disabled="disabled" style="cursor: no-drop;" ng-if="isFilled !== true">Send Billing for payment</button>
				<button class="btn btn-success btn-sm" ng-click="sendBill(refData.pharmacy.patient_id)" ng-if="isFilled && !isOTP && !refData.pharmacy.is_paid">Send billing to patient</button>&nbsp;&nbsp;
				<!--<button class="btn btn-info btn-sm" ng-click="toList(refData.pharmacy.patient_firstname,refData.pharmacy.patient_lastname,refData.pharmacy.patient_profile_pic_url,refData.ref_id,refData.date)" ng-if="allNote.length !== 0 && isFilled !== true">Add to attendance list</button>-->
				<button class="btn btn-danger btn-sm" ng-click="toAnotherPharmacy()" ng-if="isForwardable === true">Forward unticked drugs to a pharmacy</button> 
				
				<!--<button class="btn btn-success btn-sm" ng-click="done()">Done</button>
				<button class="btn btn-default btn-sm" ng-click="toAnotherPharmacy()">Forward unticked drug to a pharmacy</button>
				<button class="btn btn-info btn-sm" ng-click="toList(refData.pharmacy.patient_firstname,refData.pharmacy.patient_lastname,refData.pharmacy.patient_profile_pic_url,refData.ref_id,refData.date)" ng-if="allNote.length !== 0">Attend later</button>	-->	

				<div ng-if="isOTP && !refData.pharmacy.is_paid" ng-controller="billingController">
					<h6 class="p-0">Billing confirmation</h6><hr>
					<div>						
						<article>
							<p><strong>To: {{refData.pharmacy.patient_firstname}} {{refData.pharmacy.patient_lastname}}</strong></p>			
							<p><strong>Amount billed: </strong> {{refData.amount}}</p>
							<small>Get OTP from this patient to confirm payment. Note OTP expires in <strong>5 minutes</strong></small>
						</article>
					</div>
					
				        
					<div class="p-0">	
						<div style="width: 60%">	
					    	<input type="text" class="form-control" placeholder="Enter OTP" ng-model="pay.otp">
					    </div>
					    <div>
					    	<small>Otp will auto submit when the six digits are completed</small> 
					    </div>
				    </div>
					<div class="pt-1">
						<a href=""  ng-click="sendBill(resendPatientId,resend)">Resend OTP</a><br>
					</div>
				    <div class="clearfix"></div>
				</div>

				<div ng-if="refData.pharmacy.is_paid" style="padding: 10px 15px;position: relative;margin-top: 20px;border:1px dashed rgba(0,0,0,0.6)">					
					<h5><i class="fa fa-check pb-0" style="color:green"> Payment successful!</i></h5>
					<article style="font-size: 14px">
						<div><b>Amount paid: {{refData.pharmacy.detail.amount}}</b></div>
						<div><b>Date of payment: {{refData.pharmacy.detail.date | date: "mediumDate"}} ( <span am-Time-Ago="refData.pharmacy.detail.date"></span> )</b></div>
					</article>	
					<a href="" class="btn btn-sm" style="position: absolute;top:10px;right:10px" ng-click="newPayment()">request new</a>
				</div>

			</div>
			
			<div class="prescription-info card" ng-if="refData.pharmacy.doctor_id">
				<h6 class="text-muted pb-1" style="border-bottom: 1px solid rgba(0,0,0,0.2);">Prescribed by: </h6>
				<div class="row">
					<div class="col-sm-6 col-md-2 col-lg-2">			
						<img class="img-rounded card" src="{{refData.pharmacy.doctor_profile_pic_url}}" style="max-height:120px; max-width:120px">
					</div>
					<div class="col-sm-6 col-md-10 col-lg-10" style="line-height: 25px">								
						<strong class="font-1_1"> {{refData.pharmacy.title}} {{refData.pharmacy.doctor_firstname}} {{refData.pharmacy.doctor_lastname}}</strong><br>
						<span class="text-muted">{{refData.pharmacy.doctor_specialty}}</span>
						<span>{{refData.pharmacy.doctor_phone}}</span><br>
						<span><strong>{{refData.pharmacy.doctor_work_place}}</strong>| {{refData.pharmacy.doctor_address}}, {{refData.pharmacy.doctor_city}}, {{refData.pharmacy.doctor_country}}</span><br>
						<a href="{{refData.pharmacy.doctor_profile_url}}">View  profile.</a>						
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
	</div>
</div>


